{% extends 'base.html.twig' %}
{% block body %}

    <div class="container" style="margin-top: 10px">
        <span>Ajouté le {{ trick.createdAt|date('d/m/Y à H\\hi') }}</span>
        <h3>{{ trick.name }}</h3>
        {% for tricksPicture in trick.pictures %}
            {% if loop.first %}
                <div class="carousel-item active" style="background-image: url('{{ asset('uploads/pictures/' ~ tricksPicture.fileName) }}');height: 400px; width: 1140px">
                {% if app.user %}
                    <div class="container" style="text-align: right">
                        <div class="d-none d-md-block">
                            <a href="{{ path('snowtricks_edittricks', {'slug': trick.slug}) }}" class="btn btn-info"><span class="fa fa-pencil"></span></a>&nbsp;
                            <a href="{{ path('snowtricks_deletetricks', {'slug': trick.slug}) }}" class="btn btn-danger"><span class="fa fa-trash-o"></span></a>
                        </div>
                    </div>
                {% endif %}
            {% endif %}
            </div>
        {% else %}
            <div class="carousel-item active" style="background-image: url('https://i.stack.imgur.com/8cenv.png');height: 400px">
                {% if app.user %}
                    <div class="container" style="text-align: right">
                        <div class="d-none d-md-block">
                            <a href="{{ path('snowtricks_edittricks', {'slug': trick.slug}) }}" class="btn btn-info"><span class="fa fa-pencil"></span></a>&nbsp;
                            <a href="{{ path('snowtricks_deletetricks', {'slug': trick.slug}) }}" class="btn btn-danger"><span class="fa fa-trash-o"></span></a>
                        </div>
                    </div>
                {% endif %}
            </div>
        {% endfor %}
    </div>
    <div class="container">
        <div class="row">
            <div class="col-lg-6">
                <div class="row">
                    {% for tricksPicture in trick.pictures %}
                        {% if loop.first %}
                        {% else %}
                            <div class="col-lg-4"><img src="{{ asset('uploads/pictures/' ~ tricksPicture.fileName) }}" width="190px" height="150px" alt="" style="padding-right: 2px; margin-top: 5px"></div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
            <div class="col-lg-6">
                <div class="row">
                    {% for tricksVideo in trick.videos %}
                        <div class="col-lg-4"><span style="width: 200px;">{{ tricksVideo.htmlVideoIFrame()|raw}}</span></div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
    <div class="container">
        <h4>Description :</h4>
        <p>{{ trick.description }}</p>
        <hr>
        <h4>Espace commentaire</h4>
        {% if app.user %}
        <div class="form-group">
            {{ form_start(addCommentForm, {'attr': {'novalidate': 'novalidate'}}) }}
            {{ form_widget(addCommentForm) }}
            <button type="submit" class="btn btn-primary">Envoyer</button>
            {{ form_end(addCommentForm) }}
        </div>
        {% endif %}
        {% for comment in pagination.comments %}
            <p><img src="{{ asset('uploads/pictures/' ~ comment.user.picture.fileName) }}" height="50px" width="50px" class="rounded-circle" alt="">
                <b>{{ comment.user.username }}</b> le <em>{{ comment.createdAt|date("d-m-Y à H:i:s") }}</em>
            </p>
                <p>{{ comment.content|capitalize }}</p>
            <hr>
        {% endfor %}
    </div>

    {% if pagination.nbPages > 0 %}
        <div class="container" style="text-align: center">
            <ul class="pagination" style="display: inline-flex">
                {% if pagination.currentPage > 1 %}
                    <li class="page-item">
                        <a class="page-link" href="{{ path('snowtricks_viewtricks', {'slug': trick.slug, 'page': 1}) }}"><<</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="{{ path('snowtricks_viewtricks', {'slug': trick.slug ,'page': pagination.currentPage-1}) }}"><</a>
                    </li>
                {% endif %}
                {% for p in range(max(pagination.currentPage-4, 1), min(pagination.currentPage+4, pagination.nbPages)) %}
                    <li {% if p == pagination.currentPage %} class="active page-item"{% endif %}>
                        <a class="page-link" href="{{ path('snowtricks_viewtricks', {'slug': trick.slug, 'page': p}) }}">{{ p }}</a>
                    </li>
                {% endfor %}
                {% if pagination.currentPage < pagination.nbPages %}
                    <li class="page-item">
                        <a class="page-link" href="{{ path('snowtricks_viewtricks', {'slug': trick.slug, 'page': pagination.currentPage+1}) }}">></a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="{{ path('snowtricks_viewtricks', {'slug': trick.slug, 'page': pagination.nbPages}) }}">>></a>
                    </li>
                {% endif %}
            </ul>
        </div>
    {% endif %}

{% endblock %}